function exp_dialog(e){var t=document.documentElement;return 0-parseInt(e.offsetHeight/2)+(TBWindowMargin=t&&t.scrollTop||document.body.scrollTop)+"px"}function exp_overlay(e){return 0-parseInt(e.offsetHeight/2)+(TBWindowMargin=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop)+"px"}!function(e,t,n){if("undefined"==typeof DoubanShare){var i={},o=[],a="//img3.doubanio.com/pics/loading.gif",r=".lnk-douban-sharing",d='<div style="padding:30px 0;text-align:center;font-size:14px;color:#060;">分享成功!</div>',l='<div class="rectitle"><span class="gact rr"><a href="#" class="lnk-close">x</a></span><span class="m" >{TITLE}</span></div><div class="bd" style="position:relative;line-height:0;font-size:0;"></div>',c=function(e,t,n){var i;return/device-mobile/i.test(document.documentElement.className)&&(n=.9*document.documentElement.clientWidth),"undefined"!=typeof dui&&dui.Dialog?(i=dui.Dialog({width:n||500,content:e,title:t,isHideClose:0},!0).open(),i.node.addClass("dui-dialog-rec").find(".bd").css({position:"relative",padding:"10px 0 0 0","line-height":0,"font-size":0})):(i=$("#dialog"),0===i.length&&($('<div id="overlay"></div><div id="dialog" class="dialog-shuo"  style="width:'+(n||500)+'px;"></div>').appendTo("body"),i=$("#dialog")),i.html(e),u(),i.find(".lnk-close").click(function(e){e.preventDefault(),s()})),i},u=function(){if("undefined"!=typeof dui&&dui.Dialog&&i.currentDialog)return void i.currentDialog.update();var e=$.browser.msie?-2:16,n=$("#dialog")[0],o=n.offsetWidth,a=(t.body.offsetWidth-o)/2;$("#overlay").css({height:n.offsetHeight+e,width:o+16,left:a+5+"px"}),n.style.left=a+"px"},s=function(){return"undefined"!=typeof dui&&dui.Dialog&&i.currentDialog?(i.currentDialog.close(),void p.fire()):($("#overlay, #dialog").remove(),void p.fire())},f=function(){return o.push(1),"db-sharing-iframe"+o.length},g=function(){var e=t.createElement("iframe");return e.setAttribute("scrolling","no"),e.setAttribute("frameBorder","0"),e.setAttribute("width","100%"),e.setAttribute("allowTransparency","true"),e.src="",e},h=function(e){var t=g(),o=f()+ +new Date+(0|1e6*Math.random()),r=(e.css||"",e.text||"",e.heading||"推荐到豆瓣"),d=e.image?280:230,s=c(l.replace("{TITLE}",r),r,e.width);i.currentDialog=s,$(t).load(function(){try{t.setAttribute("height",t.contentWindow.document.body.clientHeight),u()}catch(e){}}),t.setAttribute("id",o),t.setAttribute("height",e.height||d),t.src=n+$.param(e)+"&alt=xd&callback=DoubanShare.callback&_stamp="+o,s.node?s.node.find(".bd").css("background","url("+a+") 48% 48% no-repeat").eq(0).html("").append(t):s.find(".bd").css("background","url("+a+") 48% 48% no-repeat").html("").append(t),u()},p=function(e){p.callback.push(e)},m=function(e){h(e)},b=function(){$("html").delegate(r,"click",function(e){var t=$(e.currentTarget),n=t.data(),i=["user_id","object_kind","object_id"];if(e.preventDefault(),window._USER_ABNORMAL)return void(show_abnormal&&show_abnormal());for(var o in n)"number"==typeof n[o]&&(n[o]=t.attr("data-"+o));var a={from:"snsrec2share"};for(var r in i){var d=i[r];a[d]=n[d]||0}moreurl&&moreurl(e.currentTarget,a),h(n)})};p.callback=[],p.fire=function(){for(;p.callback.length;)p.callback.pop()()},b(),i.cacheUrl={},i.updateDialog=function(e){var t=i.currentDialog;return t.node?(t.node.find("iframe").css("height",e+"px"),void t.update()):(e&&$("#dialog iframe").css("height",e+"px"),void u())},i.closeDialog=function(){var e=i.currentDialog;e.node?(e.node.find(".hd").hide(),e.node.find(".bd").css("background","none").html(d)):(e.find(".rectitle").hide(),e.find(".bd").css("background","none").html(d)),u(),setTimeout(function(){s()},1e3)},i.share=m,i.onDialogClose=p,e.DoubanShare=i,(new Image).src=a}}(window,document,rec_url);