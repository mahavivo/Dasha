!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.shear=n()}(this,function(){"use strict";function e(e){return[].slice.call(e)}function n(t){var r=[];return t.nodeType===Node.TEXT_NODE&&r.push(t),e(t.childNodes).map(function(e){r=r.concat(n(e))}),r}function t(e,n,t,r){return void 0===n&&(n=""),void 0===t&&(t=""),void 0===r&&(r=""),{isCuted:e,fullHTML:n,cutedHTML:t,cutedWithAfterHTML:r}}var r=!("modify"in window.getSelection());return function(o,i,d){if(void 0===i&&(i=2),void 0===d&&(d=null),!o.childNodes.length)return t(!1);var l,a,c,u,f,g,s,h=window.getSelection(),v=o.innerHTML,m=o.getBoundingClientRect().height;if(h.collapse(o,0),r)a=o,c=i,u=document.createRange(),f=n(a),g=null,s=0,u.setStart(f[0],0),function(){for(var e=0;e<f.length;e++)for(var n=0;n<f[e].length;n++){u.setEnd(f[e],n);var t=u.getBoundingClientRect().height;if(null===g&&(g=t),t!==g&&(s++,g=t),c<s)return u.setStart(f[e],n),u.setEnd(f[e],n)}}(),l=u;else{for(var p=0;p<i;p++)if(h.modify("extend","right","character"),h.modify("extend","right","lineboundary"),!o.contains(h.focusNode)){h.selectAllChildren(o);break}h.collapseToEnd(),l=h.getRangeAt(0).cloneRange()}h.selectAllChildren(o),l.setEnd(h.getRangeAt(0).endContainer,h.getRangeAt(0).endOffset),l.cloneRange().deleteContents();var C=o.innerHTML,R=v!==C,T=C,E=o.getBoundingClientRect().height;if(E<m&&d){var y=function(n){var t=document.createElement("DIV");t.innerHTML=n;var r=document.createDocumentFragment();return e(t.childNodes).forEach(function(e){return r.appendChild(e)}),r}(d),A=n(o),H=A[A.length-1],L=H.length,M=document.createRange();M.setStart(H,L),M.setEnd(H,L),o.appendChild(y),function(){for(var e=A.length-1;0<=e;e--)for(var n=A[e].length-1;0<=n;n--){if(o.getBoundingClientRect().height<=E)return;var t=document.createRange();t.setStart(A[e],n),t.setEnd(A[e],n+1),t.deleteContents();var r=A[e].parentNode;r&&r!==o&&!r.textContent&&o.removeChild(r)}}(),T=o.innerHTML}return h.removeAllRanges(),t(R,v,C,T)}});